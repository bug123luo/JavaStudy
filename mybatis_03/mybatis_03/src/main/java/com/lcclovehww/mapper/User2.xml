<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lcclovehww.mapper.UserMapper2">
	<!-- 采用这种方式的枚举，必须修改数据库表中的对应字段为varchar -->
	<resultMap type="com.lcclovehww.pojo.User" id="userMap">
		<id column="id" property="id" javaType="long" jdbcType="BIGINT"/>
		<result column="user_name" property="userName"/>
		<result column="nickname" property="nickname"/>
		<result column="sex" property="sex" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/>
		<result column="email" property="email"/>
		<result column="mobile" property="mobile"/>
		<result column="remark" property="remark"/>
	</resultMap>
	
	<select id="getUser" parameterType="long" resultMap="userMap">
		select id, user_name, nickname, sex, email, mobile, remark from user where id=#{id}
	</select>
	
	<insert id="insertUser" parameterType="com.lcclovehww.pojo.User" useGeneratedKeys="true" keyProperty="id">
		<selectKey keyProperty="id" resultType="int" order="BEFORE">
			select if(max(id) is null, 1,max(id)+1) as newId from user
		</selectKey>
		insert into user(id, user_name, nickname, sex, email, mobile, remark) 
		values(#{id},#{userName}, #{nickname}, #{sex ,typeHandler=org.apache.ibatis.type.EnumTypeHandler}, #{email}, #{mobile}, #{remark})
	</insert>
</mapper>